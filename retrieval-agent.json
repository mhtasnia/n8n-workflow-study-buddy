{
  "name": "retrieval-agent",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "=\n---\n\n## üßë‚Äçüéì **Retriever Agent ‚Äì User Prompt**\n```text\nThe student has asked the following question:\n\n{{ $json.query }}\n\nSearch the student‚Äôs vector database of study materials and return the most relevant text chunks that may help answer this question.\n\nRespond in the format provided in the system message.\n",
        "options": {
          "systemMessage": "You are the Retriever Agent in a multi-agent academic assistant system.\n\nYour job is to:\n- Interpret the student‚Äôs question\n- Perform a semantic search over the vector database containing their study materials\n- Return 3‚Äì5 of the most relevant chunks of information\n\nYou do not answer the question or summarize it ‚Äî you only find relevant content.\n\nIf the query asks for an ‚Äúanalysis‚Äù, ‚Äúsummary‚Äù, ‚Äúcritique‚Äù, or similar, make sure to still retrieve directly relevant factual content (not conclusions).\n\nReturn the results in this format:\n```json\n{\n  \"retrieved_chunks\": [\n    { \"source\": \"Biology Textbook\", \"text\": \"...\" },\n    { \"source\": \"Lecture Notes\", \"text\": \"...\" }\n  ]\n}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        416,
        0
      ],
      "id": "d99b5e17-1cf1-4647-ab42-1ea3ae652361",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        416,
        192
      ],
      "id": "2b3de2be-4a2e-411a-8e51-e29a20c85ebf",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "FXXknlqzEWtpAmPQ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "description": "[Testing information, types and techniques]",
        "topK": 5
      },
      "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
      "typeVersion": 1.1,
      "position": [
        832,
        192
      ],
      "id": "125cae18-0508-4a01-b10a-257ae35436ca",
      "name": "Answer questions with a vector store"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1168,
        336
      ],
      "id": "201025ce-777b-48a1-bcd8-5bc640422345",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "FXXknlqzEWtpAmPQ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "pineconeIndex": {
          "__rl": true,
          "value": "library-rag-db",
          "mode": "list",
          "cachedResultName": "library-rag-db"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.3,
      "position": [
        720,
        400
      ],
      "id": "2b964521-5b83-4818-b70a-4f5c60d552b6",
      "name": "Pinecone Vector Store",
      "credentials": {
        "pineconeApi": {
          "id": "ESEbIEtPyLlBHNyb",
          "name": "PineconeApi account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        848,
        592
      ],
      "id": "f335a023-0a02-4f08-b5ae-1b5d65478fdc",
      "name": "Embeddings Google Gemini",
      "credentials": {
        "googlePalmApi": {
          "id": "FXXknlqzEWtpAmPQ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "inputSource": "jsonExample",
        "jsonExample": "{  \"query\": \"No query provided. Please provide a question to search the database.\"\n}"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -64,
        0
      ],
      "id": "a906a532-87ee-4d12-be71-b5ff67beb192",
      "name": "When Executed by Another Workflow"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a3094337-72e1-4b85-ab1a-fa361d367322",
              "name": "query",
              "value": "={{ $json.query }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        192,
        0
      ],
      "id": "d0333cd7-2f2c-4e8a-ae5e-6a1fe66a20cd",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.query }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        528,
        256
      ],
      "id": "afb9dbf6-a32e-47e6-9f79-a8e04af26adc",
      "name": "Simple Memory"
    }
  ],
  "pinData": {},
  "connections": {
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Answer questions with a vector store": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Answer questions with a vector store",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store": {
      "ai_vectorStore": [
        [
          {
            "node": "Answer questions with a vector store",
            "type": "ai_vectorStore",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Google Gemini": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        []
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "3e628c55-9d6f-467b-a081-844e79374b36",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "287fa767a19331fafe6f7c177efa18a40926b8ca5790001323089bca68ea489e"
  },
  "id": "0kgIqp3dEY6vaIxw",
  "tags": []
}